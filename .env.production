# ============================================
# PRODUCTION ENVIRONMENT CONFIGURATION
# ============================================
# For deployment at vagolan.com/bulq
#
# ARCHITECTURE:
# - Upstream reverse proxy at vagolan.com handles HTTPS and routes /bulq/* to this app
# - This app runs on HTTP (port 8080 by default) behind the upstream proxy
# - No SSL certificates needed here (handled by upstream proxy)
#
# IMPORTANT: After copying this file to .env, you MUST:
# 1. Generate a strong SECRET_KEY: openssl rand -hex 32
# 2. Set a strong POSTGRES_PASSWORD (at least 16 characters)
# 3. Update DATABASE_URL with the same password
# 4. Review all settings below
# ============================================

# ============================================
# ENVIRONMENT CONFIGURATION
# ============================================
ENV=production

# ============================================
# SECURITY CONFIGURATION
# ============================================
# REQUIRED: Generate with: openssl rand -hex 32
SECRET_KEY=REPLACE_WITH_GENERATED_SECRET_KEY

# REQUIRED: Must be true in production (HTTPS required)
SECURE_COOKIES=true

# ============================================
# DATABASE CONFIGURATION
# ============================================
POSTGRES_DB=bulq
POSTGRES_USER=bulq
# REQUIRED: Change to a strong password (16+ characters)
POSTGRES_PASSWORD=REPLACE_WITH_STRONG_PASSWORD

# REQUIRED: Update with the same password as above
DATABASE_URL=postgresql://bulq:REPLACE_WITH_STRONG_PASSWORD@db:5432/bulq

# Database Connection Pool Configuration
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=10
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600

# REQUIRED: Must be "database" in production
REPO_MODE=database

# ============================================
# SESSION CONFIGURATION
# ============================================
SESSION_EXPIRY_HOURS=24

# ============================================
# CORS CONFIGURATION
# ============================================
# REQUIRED: Set to production domain
ALLOWED_ORIGINS=https://vagolan.com

# ============================================
# PORT CONFIGURATION
# ============================================
# Port to expose for upstream reverse proxy
# The upstream proxy will forward vagolan.com/bulq/* to this port
FRONTEND_PORT=8080

# ============================================
# LOGGING CONFIGURATION
# ============================================
LOG_LEVEL=INFO
LOG_FORMAT=json
LOG_FILE=/app/logs/app.log

# ============================================
# SETUP INSTRUCTIONS
# ============================================
# 1. Copy this file:
#    cp .env.production .env
#
# 2. Generate SECRET_KEY:
#    openssl rand -hex 32
#    Then replace REPLACE_WITH_GENERATED_SECRET_KEY above
#
# 3. Set strong database password:
#    Replace both instances of REPLACE_WITH_STRONG_PASSWORD
#    (in POSTGRES_PASSWORD and DATABASE_URL)
#
# 4. Deploy:
#    docker compose build
#    docker compose up -d
#
# 5. Verify:
#    docker compose ps
#    docker compose logs -f
#    curl https://vagolan.com/bulq
#
# ============================================
# SECURITY CHECKLIST
# ============================================
# [ ] Strong SECRET_KEY generated (32+ chars)
# [ ] Strong database password set (16+ chars)
# [ ] ENV=production
# [ ] SECURE_COOKIES=true
# [ ] ALLOWED_ORIGINS=https://vagolan.com
# [ ] DOMAIN=vagolan.com
# [ ] REPO_MODE=database
# [ ] Ports 80 and 443 open on firewall
# [ ] DNS pointing to server IP
# [ ] .env file permissions: chmod 600 .env
